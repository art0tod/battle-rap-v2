# TODO: MVP платформы хип-хоп баттлов

---

## 0. Зафиксировать рамки MVP

- [ ] Описать, что входит в первый релиз:
  - один основной турнир («Независимый баттл»)
  - два отбора + парные раунды
  - роли: гость, участник, судья, админ
  - загрузка только аудио (без видео), текст куплета опционально
  - голосование только судей (без голосования зрителей на старте)
- [ ] Описать, что **не** делаем в MVP:
  - нет личных вызовов участник-участник
  - нет сложных чатов и личных сообщений
  - нет отдельной системы донатов
  - нет отдельной системы сезонов и лиг (только один турнир)

---

## 1. Роли и базовые сценарии

- [x] Чётко описать, что может:
  - гость (просмотр, прослушивание, чтение, регистрация)
  - участник (создать профиль, подать трек на отбор, участвовать в парных раундах)
  - судья (авторизоваться как судья, открывать список треков/пар, ставить оценки)
  - админ (управлять турниром, участниками, судьями, модерация)
- [x] Описать, какие действия недоступны каждой роли (например, гость не может голосовать).

---

## 2. Структура турнира и раундов

- [x] Описать параметры турнира:
  - название, описание, сроки
  - максимальное количество участников, формат (128 или 256)
- [x] Описать логику **отборочного раунда 1**:
  - участник подаёт один трек
  - каждый трек видит ограниченное число судей
  - судья ставит «прошёл / не прошёл»
  - участник проходит при 3 положительных решениях из 5
- [x] Описать логику **отборочного раунда 2**:
  - участник, прошедший отбор 1, загружает новый трек
  - каждый трек получает оценки по шкале 0–5
  - по суммарным баллам выбираются N лучших (128/256)
- [x] Описать логику **парных раундов**:
  - участники раскидываются по сетке
  - у пары есть тема и дедлайн
  - каждый участник загружает трек в рамках пары
  - судьи оценивают каждый трек по критериям 0–3
  - на основе сумм определяется победитель пары

---

## 3. Структура страниц / экранов

- [x] Описать список основных страниц:
  - главная: `src/app/page.tsx` собирает HeroSection, AboutSection, NewParticipantsSection, BattleRatingSection, PostsSection и ApplySection, то есть выдаёт историю проекта, актуальные рейтинги, последние новости и чёткие CTA «слушать» / «участвовать», сохраняя простой скролл для гостьевого знакомства.
  - страница турнира: `src/app/battles/page.tsx` → `BattlesClient.tsx` подгружает список баттлов / матчей, показывает участников, статус раунда, дедлайны и оценки в виде карточек с визуальными метками («upcoming», «finished» и т.п.), чтобы зритель видел этапы, сетку и правила судейства в контексте API-данных.
  - страница регистрации / входа: `components/auth/AuthModal/AuthModal.tsx` реализует модальное окно с формой на почту и пароль, переключением между входом и регистрацией, проверкой подтверждения пароля и базовой обработкой ошибок API, что покрывает MVP-авторизацию без сторонних соцсетей.
  - профиль участника: `src/app/profile/page.tsx` отдаёт `ProfileSection`, который (через `ProfileService` и `PublicService`) вытаскивает ник, аватар, соцсети, список треков и статус участника, демонстрируя прогресс по этапам и статистику на одной странице.
  - список участников / работ: `src/app/members/page.tsx` → `MembersSection` вызывает `PublicService.listPublicParticipants`, предлагает поиск, фильтр по роли (баттлер/судья) и сортировку по дате/рейтингу/количеству баттлов, выводит карточки с аватаром, городом, средним баллом и ссылкой на профиль.
  - страница трека: в MVP трек-просмотр идёт через обобщённый `MusicPlayer` (`components/layout/MusicPlayer/MusicPlayer.tsx`), но в рамках структуры её можно расширить так, чтобы карточка из `BattlesClient` открывала отдельную страницу с плеером, текстом куплета, счётчиками лайков/комментариев и краткой историей загрузки (дата, статус загрузки) — основу для будущей отдельной страницы трека.
  - кабинет судьи: `src/app/judge/page.tsx` предоставляет дашборд с назначениями, деталями баттлов, шкалой оценок, рубриками и кнопками для «принять / отклонить» раунд по API `battleRapApi`, отображая комментарии, дедлайны и текущий статус каждого задания.
  - кабинет админа: `src/app/admin/page.tsx` запускает `AdminDashboard`, а в админке есть секции `admin/battles`, `admin/users`, `admin/submissions`, `admin/media`, которые через `battleRapApi` дают статистику по пользователям, наблюдаемым баттлам, медиа и сообщениям для модерации; на MVP достаточно обзора количества участников, очереди отправок и кнопки обновления.

---

## 4. Регистрация, вход и профиль

- [x] Описать сценарий регистрации:
  - регистрация по почте (подтверждение не обязательно в MVP)
  - вход/привязка VK (опционально, если нужно сразу)
- [x] Описать структуру профиля участника:
  - ник, аватар, краткое описание
  - соцсети (ссылки)
  - список его треков в баттлах
  - статус в турнире (в отборе, в сетке, вылетел и т.д.)
- [x] Описать ограничения:
  - один человек — один профиль
  - один профиль — одна заявка в текущем турнире

---

## 5. Участие и загрузка работ

- [x] Описать общий сценарий:
  - участник регистрируется
  - подаёт заявку на участие в турнире
  - попадает в список участников отбора
- [x] Описать правила загрузки треков:
  - только один трек на раунд
  - формат/размер файла (ограничения текстом)
  - сроки загрузки (после дедлайна — загрузка закрыта)
- [x] Описать предупреждения и статусы:
  - черновик / загружен / принят / отклонён
  - сообщение участнику при успешной/неуспешной загрузке

---

## 6. Судейство и подсчёт результатов

- [x] Описать, как судья получает доступ к своему списку:
  - отдельный вход судьи
  - список треков для отбора 1
  - список треков для отбора 2
  - список парных баттлов
- [x] Для **отбора 1**:
  - интерфейс для прослушивания трека
  - кнопки «прошёл / не прошёл»
  - блокировка повторной смены решения (по договорённости)
- [x] Для **отбора 2**:
  - интерфейс: трек + шкала 0–5
  - сохранение выставленных баллов
- [x] Для **парных раундов**:
  - в паре судья видит два трека
  - критерии: рифмы / смысл / раскрытие темы / общее впечатление (каждый 0–3)
  - расчёт итогового балла по каждому треку
  - определение победителя пары по сумме
- [x] Описать правила обработки ничьих (на старте можно запретить ничьи — например, требовать выбора победителя).

---

## 7. Отображение результатов пользователям

- [x] Описать, как зрители видят:
  - список треков отбора (без оценок судей или с агрегированным результатом, по решению)
  - список участников, прошедших дальше
  - сетку парных раундов с результатами
- [x] Описать, какие данные открыты:
  - показывать ли промежуточные оценки судей
  - формат итогового результата (баллы, победитель по парам и т.д.)
- [x] Описать раздел «Статистика участника»:
  - этап, до которого дошёл
  - суммарные баллы в отборах
  - победы/поражения в парных раундах

---

## 8. Лайки, комментарии и активность зрителей

- [ ] Описать базовую логику лайков:
  - кто может ставить лайк (гость / только зарегистрированные)
  - один лайк от человека на трек
- [ ] Описать логику комментариев:
  - кто может комментировать
  - ограничения по длине
  - базовая защита от спама (например, задержка между комментариями)
- [ ] Описать отображение:
  - сортировка треков по популярности (по лайкам/прослушиваниям)
  - отображение количества лайков и комментариев

---

## 9. Администрирование и модерация

- [x] Описать базовые возможности админа в MVP:
  - создать турнир, задать даты и этапы
  - добавить / удалить участника
  - назначить / убрать судью
  - вручную изменить статус трека или участника (на случай форс-мажора)
- [x] Описать модерацию:
  - скрыть трек или комментарий
  - заблокировать пользователя (минимально)
- [x] Описать страницу админ-обзора:
  - количество участников
  - прогресс по этапам
  - проблемные записи (например, треки без оценок после дедлайна)

---

## 10. Ограничения, безопасность и стабильность

- [ ] Зафиксировать ограничения:
  - максимальный размер аудиофайла
  - ограничение по длине описаний, ников
- [ ] Описать обработку ошибок:
  - что видит пользователь при неудачной загрузке
  - что видит судья при недоступности трека
- [ ] Описать поведение при перегрузке:
  - при большом количестве одновременных прослушиваний (минимально, на уровне ожиданий).

---

## 11. Проверка и тестовые данные

- [x] Составить список тестовых сценариев:
  - регистрация участника и подача трека в отбор 1
  - прохождение участника через оба отбора и попадание в сетку
  - оценка треков судьями на всех этапах
  - появление результатов на страницах зрителей
- [x] Подготовить тестовые профили:
  - несколько тестовых участников
  - несколько тестовых судей
  - один тестовый админ
- [x] Проверить, что все основные маршруты «от регистрации до результата» работают без ручного вмешательства.
